<div id="spec_form">
<div id="spec_select" {if condition="$items"}{else/}style="display:none;"{/if}>
    <div id="spec_form_item"  >
        {volist name="spec" id="vo"}
        <div class="layui-form-item" pane style="height:36px">
            <label class="layui-form-label">{$vo.name}</label>
            <div class="layui-input-block">
                {volist name="vo.specValue" id="v"}
                <input type="checkbox" name="spec[{$vo.name}][]" {if condition="$v['isSelected'] eq 'true'"} checked="true"  {/if} value="{$v.value}" lay-skin="primary" title="{$v.value}" lay-filter="spec_select">
                {/volist}
            </div>
        </div>
        {/volist}
    </div>
    <div class="layui-form-item">
        <div class="layui-input-inline">
            <button class="layui-btn layui-btn-sm generate-spec">生成规格</button>
        </div>
    </div>

    <div id="more_spec" >
        {if condition="$items"}
        <table class="layui-table" lay-size="sm">
            <colgroup>
                <col width="150">
                <col width="200">
                <col>
            </colgroup>
            <thead>
            <tr>
                <th>默认货品</th>
                <th>货号</th>
                <th>规格</th>
                <th>库存</th>
                <th>销售价</th>
                <th>一级价格</th>
                <th>二级价格</th>
                <th>三级价格</th>
                <th>四级价格</th>
                <th>五级价格</th>
                <th>六级价格</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            {volist name="items" id="vo"}
            <tr>
                <td>
                    <input type="hidden" name="product[{$vo.spec_name}][id]" value="{$vo.product_id}">
                    <input type="checkbox" name="product[{$vo.spec_name}][is_defalut]" title="是否默认" value="1" {if condition="$vo['is_defalut'] eq 1"} checked="true"  {/if} class="isdefalut" lay-filter="isdefalut">
                </td>
                <td>
                    <input type="text" name="product[{$vo.spec_name}][sn]" value="{$vo.sn}"  placeholder="货号" autocomplete="off" class="layui-input">
                </td>
                <td>
                    {$vo.spec_name}
                </td>
                <td>
                    <input type="text" name="product[{$vo.spec_name}][stock]" value="{$vo.stock}"  placeholder="库存" autocomplete="off" class="layui-input">
                </td>
                <td>
                    <input type="text" name="product[{$vo.spec_name}][price]" value="{$vo.price}"  placeholder="销售价" autocomplete="off" class="layui-input">
                </td>

                <!--   会员等级价格开始   -->
                <td>
                    <input type="text" name="product[{$vo.spec_name}][price1]" value="{$vo.price1}"   placeholder="会员等级价格" autocomplete="off" class="layui-input">
                </td>
                <td>
                    <input type="text" name="product[{$vo.spec_name}][price2]" value="{$vo.price2}"   placeholder="会员等级价格" autocomplete="off" class="layui-input">
                </td>
                <td>
                    <input type="text" name="product[{$vo.spec_name}][price3]" value="{$vo.price3}"   placeholder="会员等级价格" autocomplete="off" class="layui-input">
                </td>
                <td>
                    <input type="text" name="product[{$vo.spec_name}][price4]" value="{$vo.price4}"   placeholder="会员等级价格" autocomplete="off" class="layui-input">
                </td>
                <td>
                    <input type="text" name="product[{$vo.spec_name}][price5]" value="{$vo.price5}"   placeholder="会员等级价格" autocomplete="off" class="layui-input">
                </td>
                <td>
                    <input type="text" name="product[{$vo.spec_name}][price6]" value="{$vo.price6}"   placeholder="会员等级价格" autocomplete="off" class="layui-input">
                </td>
                <!--   会员等级价格结束   -->


                <td>
                    <a class="layui-btn layui-btn-danger layui-btn-xs del-class" >删除</a>
                </td>
            </tr>
            {/volist}
            </tbody>
        </table>
        {else/}
        {/if}
    </div>
</div>

<div id="no_spec" {if condition="$items"}style="display:none;"{else/}{/if}>
    <div class="layui-form-item">
        <label class="layui-form-label">销售价：</label>
        <div class="layui-input-inline">
            <input type="hidden" name="product[id]" value="{$product.id}">
            <input type="text" name="goods[price]" value="{$goods.price}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">销佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[agent_discount]" value="{$goods.agent_discount}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">分佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[commission_discount]" value="{$goods.commission_discount}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">一级价格：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[price1]" value="{$goods.price1}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">销佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[agent_discount1]" value="{$goods.agent_discount1}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">分佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[commission_discount1]" value="{$goods.commission_discount1}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">二级价格：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[price2]" value="{$goods.price2}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">销佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[agent_discount2]" value="{$goods.agent_discount2}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">分佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[commission_discount2]" value="{$goods.commission_discount2}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">三级价格：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[price3]" value="{$goods.price3}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">销佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[agent_discount3]" value="{$goods.agent_discount3}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">分佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[commission_discount3]" value="{$goods.commission_discount3}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">四级价格：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[price4]" value="{$goods.price4}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">销佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[agent_discount4]" value="{$goods.agent_discount4}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">分佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[commission_discount4]" value="{$goods.commission_discount4}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">五级价格：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[price5]" value="{$goods.price5}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">销佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[agent_discount5]" value="{$goods.agent_discount5}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">分佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[commission_discount5]" value="{$goods.commission_discount5}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">六级价格：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[price6]" value="{$goods.price6}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">销佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[agent_discount6]" value="{$goods.agent_discount6}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">分佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[commission_discount6]" value="{$goods.commission_discount6}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">平台会员价：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[mall_member_price]" value="{$goods.mall_member_price}" lay-verify="title" autocomplete="off" placeholder="请输入平台会员价格" class="layui-input">
        </div>
        <label class="layui-form-label">销佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[mall_agent_discount]" value="{$goods.mall_agent_discount}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">分佣比例：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[mall_commission_discount]" value="{$goods.mall_agent_discount}" placeholder="￥" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">货号：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[sn]" value="{$goods.bn}" lay-verify="title" autocomplete="off" placeholder="请输入货号" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">库存：</label>
        <div class="layui-input-inline">
            <input type="text" name="goods[stock]" value="{$goods.stock}"  lay-verify="title" autocomplete="off" placeholder="请输入商品库存" class="layui-input">
        </div>
    </div>
</div>
</div>


{if condition="$canOpenSpec eq 'true' "}
<div class="layui-form-item">
    <label class="layui-form-label" >开启规格：</label>
    <div class="layui-input-inline">
        {if condition="$items"}
        <button type="button" class="layui-btn layui-btn-sm" id="open_spec" is_open="true" lay-filter="open_spec" data-id="{$typeInfo.id}" style="margin-top:5px;">关闭</button>
        {else/}
        <button type="button" class="layui-btn layui-btn-sm" id="open_spec" is_open="false" lay-filter="open_spec" data-id="{$typeInfo.id}" style="margin-top:5px;">开启</button>
        {/if}
    </div>
</div>
{/if}



{notempty name="typeParams"}
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;"><legend>商品参数</legend></fieldset>
{volist name="typeParams" id="vo"}
<div class="layui-form-item">
    <label class="layui-form-label">{$vo.params.name}：</label>
    <div class="layui-input-inline">
        {if condition="$vo.params.type eq 'text'"}
            <input type="text" name="goods[params][{$vo.params.name}]" value="{$goodsParams[$vo.params.name]}" class="layui-input">
        {elseif condition="$vo.params.type eq 'checkbox'"/}
            {volist name="$vo.params.value" id="params"}
                {if condition="$goodsParams[$vo['params']['name']]"}
                <input type="checkbox" name="goods[params][{$vo.params.name}][{$params}]" lay-skin="primary" title="{$params}" {if condition="in_array($params, $goodsParams[$vo['params']['name']])"}checked{/if}>
                {else}
                <input type="checkbox" name="goods[params][{$vo.params.name}][{$params}]" lay-skin="primary" title="{$params}">
                {/if}
            {/volist}
        {elseif condition="$vo.params.type eq 'radio'"/}
            {volist name="$vo.params.value" id="params" key="p"}
                {if condition="$goodsParams[$vo['params']['name']]"}
                    <input type="radio" name="goods[params][{$vo.params.name}]" value="{$params}" title="{$params}" {if condition="$params eq $goodsParams[$vo['params']['name']]"}checked{/if}>
                {else}
                    <input type="radio" name="goods[params][{$vo.params.name}]" value="{$params}" title="{$params}" {if condition="$p eq 1"}checked{/if}>
                {/if}
            {/volist}
        {/if}
    </div>
</div>
{/volist}
{/notempty}
<script>
    layui.use('form', function(){
        var form = layui.form;
        form.render();
        form.on('checkbox(isdefalut)', function(data){
            if(data.elem.checked){
                var checkedName = $(data.elem).attr("name");
                $(".isdefalut").each(function (i,dom) {
                    var name = $(dom).attr("name");
                    if(name != checkedName){
                        $(dom).attr("checked",false);
                        $(dom).attr("value","0");
                        $("#more_spec .layui-form-checkbox").removeClass('layui-form-checked');
                    }else {
                        $(dom).attr("checked", true);
                        $(dom).attr("value","1");
                    }
                });
                $(data.othis).addClass("layui-form-checked");
            }else{
                $(dom).attr("checked",false);
                $(dom).attr("value","0");
                $("#more_spec .layui-form-checkbox").removeClass('layui-form-checked');
            }
        });
    });
</script>